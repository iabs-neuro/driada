============================= test session starts ==============================
platform darwin -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /opt/anaconda3/envs/driada/bin/python3.10
cachedir: .pytest_cache
rootdir: /Users/nikita/PycharmProjects/driada2
configfile: pytest.ini
testpaths: tests
plugins: cov-6.2.1
collecting ... collected 541 items

tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_intense_to_pca_pipeline PASSED [  0%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_intense_to_manifold_learning PASSED [  0%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_mvdata_experiment_integration PASSED [  0%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_dimensionality_estimation_integration PASSED [  0%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_memory_efficiency PASSED [  0%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_data_flow_validation PASSED [  1%]
tests/integration/test_integration.py::TestINTENSEToDRIntegration::test_error_handling_integration PASSED [  1%]
tests/integration/test_manifold_neural_data.py::test_neural_manifold_dimensionality_estimation PASSED [  1%]
tests/integration/test_manifold_neural_data.py::test_dimensionality_guided_reconstruction PASSED [  1%]
tests/integration/test_manifold_neural_data.py::test_circular_manifold_reconstruction PASSED [  1%]
tests/integration/test_manifold_neural_data.py::test_spatial_manifold_reconstruction PASSED [  2%]
tests/integration/test_manifold_neural_data.py::test_geodesic_distance_preservation FAILED [  2%]

=================================== FAILURES ===================================
_____________________ test_geodesic_distance_preservation ______________________
tests/integration/test_manifold_neural_data.py:496: in test_geodesic_distance_preservation
    assert all(score > 0.3 for score in geodesic_scores.values())
E   assert False
E    +  where False = all(<generator object test_geodesic_distance_preservation.<locals>.<genexpr> at 0x14127a340>)
----------------------------- Captured stdout call -----------------------------
Calculating PCA embedding...
Adjacency symmetry confirmed
KNN preservation scores: {'pca': 0.285425, 'isomap': 0.4176}
=========================== short test summary info ============================
FAILED tests/integration/test_manifold_neural_data.py::test_geodesic_distance_preservation
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
=================== 1 failed, 11 passed in 108.94s (0:01:48) ===================


ERRORS:
