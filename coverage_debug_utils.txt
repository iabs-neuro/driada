============================= test session starts ==============================
platform darwin -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /opt/anaconda3/envs/driada/bin/python
cachedir: .pytest_cache
rootdir: /Users/nikita/PycharmProjects/driada2
configfile: pytest.ini
plugins: timeout-2.4.0, cov-6.2.1
collecting ... collected 111 items

tests/unit/utils/test_plot.py::TestMakeBeautiful::test_make_beautiful_basic PASSED [  0%]
tests/unit/utils/test_plot.py::TestMakeBeautiful::test_make_beautiful_custom_params PASSED [  1%]
tests/unit/utils/test_plot.py::TestMakeBeautiful::test_make_beautiful_with_title PASSED [  2%]
tests/unit/utils/test_plot.py::TestMakeBeautiful::test_make_beautiful_with_legend PASSED [  3%]
tests/unit/utils/test_plot.py::TestMakeBeautiful::test_make_beautiful_dpi PASSED [  4%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_basic PASSED [  5%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_custom_size PASSED [  6%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_style_kwargs PASSED [  7%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_subplots PASSED [  8%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_subplots_no_squeeze PASSED [  9%]
tests/unit/utils/test_plot.py::TestCreateDefaultFigure::test_create_default_figure_shared_axes PASSED [  9%]
tests/unit/utils/test_plot.py::TestPlotMat::test_plot_mat_basic PASSED   [ 10%]
tests/unit/utils/test_plot.py::TestPlotMat::test_plot_mat_existing_axis PASSED [ 11%]
tests/unit/utils/test_plot.py::TestPlotMat::test_plot_mat_no_colorbar PASSED [ 12%]
tests/unit/utils/test_plot.py::TestPlotMat::test_plot_mat_custom_params PASSED [ 13%]
tests/unit/utils/test_plot.py::TestPlotMat::test_plot_mat_imshow_kwargs PASSED [ 14%]
tests/unit/utils/test_plot.py::TestIntegration::test_full_workflow PASSED [ 15%]
tests/unit/utils/test_plot.py::TestIntegration::test_single_vs_multiple_axes PASSED [ 16%]
tests/unit/utils/test_gif.py::TestEraseAll::test_erase_all_basic PASSED  [ 17%]
tests/unit/utils/test_gif.py::TestEraseAll::test_erase_all_empty_signature PASSED [ 18%]
tests/unit/utils/test_gif.py::TestEraseAll::test_erase_all_nonexistent_directory PASSED [ 18%]
tests/unit/utils/test_gif.py::TestEraseAll::test_erase_all_no_matching_files PASSED [ 19%]
tests/unit/utils/test_gif.py::TestSaveImageSeries::test_save_image_series_with_titles PASSED [ 20%]
tests/unit/utils/test_gif.py::TestSaveImageSeries::test_save_image_series_without_titles PASSED [ 21%]
tests/unit/utils/test_gif.py::TestSaveImageSeries::test_save_image_series_creates_directory PASSED [ 22%]
tests/unit/utils/test_gif.py::TestSaveImageSeries::test_save_image_series_different_extension PASSED [ 23%]
tests/unit/utils/test_gif.py::TestCreateGifFromImageSeries::test_create_gif_basic PASSED [ 24%]
tests/unit/utils/test_gif.py::TestCreateGifFromImageSeries::test_create_gif_with_erase PASSED [ 25%]
tests/unit/utils/test_gif.py::TestCreateGifFromImageSeries::test_create_gif_custom_duration PASSED [ 26%]
tests/unit/utils/test_gif.py::TestCreateGifFromImageSeries::test_create_gif_no_matching_images PASSED [ 27%]
tests/unit/utils/test_gif.py::TestCreateGifFromImageSeries::test_create_gif_sorted_order PASSED [ 27%]
tests/unit/utils/test_gif.py::TestIntegration::test_full_workflow PASSED [ 28%]
tests/unit/utils/test_spatial.py::TestOccupancyMap::test_compute_occupancy_map_basic PASSED [ 29%]
tests/unit/utils/test_spatial.py::TestOccupancyMap::test_compute_occupancy_map_smoothing PASSED [ 30%]
tests/unit/utils/test_spatial.py::TestOccupancyMap::test_compute_occupancy_map_min_occupancy PASSED [ 31%]
tests/unit/utils/test_spatial.py::TestOccupancyMap::test_compute_occupancy_map_auto_bounds PASSED [ 32%]
tests/unit/utils/test_spatial.py::TestRateMap::test_compute_rate_map_basic PASSED [ 33%]
tests/unit/utils/test_spatial.py::TestRateMap::test_compute_rate_map_smoothing PASSED [ 34%]
tests/unit/utils/test_spatial.py::TestRateMap::test_compute_rate_map_no_spikes PASSED [ 35%]
tests/unit/utils/test_spatial.py::TestPlaceFields::test_extract_place_fields_single_field PASSED [ 36%]
tests/unit/utils/test_spatial.py::TestPlaceFields::test_extract_place_fields_multiple PASSED [ 36%]
tests/unit/utils/test_spatial.py::TestPlaceFields::test_extract_place_fields_size_threshold PASSED [ 37%]
tests/unit/utils/test_spatial.py::TestSpatialInformation::test_compute_spatial_information_rate_uniform PASSED [ 38%]
tests/unit/utils/test_spatial.py::TestSpatialInformation::test_compute_spatial_information_rate_localized PASSED [ 39%]
tests/unit/utils/test_spatial.py::TestSpatialInformation::test_compute_spatial_information_rate_no_firing PASSED [ 40%]
tests/unit/utils/test_spatial.py::TestGridScore::test_compute_grid_score_regular_grid PASSED [ 41%]
tests/unit/utils/test_spatial.py::TestGridScore::test_compute_grid_score_random PASSED [ 42%]
tests/unit/utils/test_spatial.py::TestGridScore::test_compute_grid_score_single_peak PASSED [ 43%]
tests/unit/utils/test_spatial.py::TestSpatialDecoding::test_compute_spatial_decoding_accuracy_perfect PASSED [ 44%]
tests/unit/utils/test_spatial.py::TestSpatialDecoding::test_compute_spatial_decoding_accuracy_random PASSED [ 45%]
tests/unit/utils/test_spatial.py::TestSpatialDecoding::test_compute_spatial_decoding_accuracy_with_logger PASSED [ 45%]
tests/unit/utils/test_spatial.py::TestSpatialMI::test_compute_spatial_information_arrays PASSED [ 46%]
tests/unit/utils/test_spatial.py::TestSpatialMI::test_compute_spatial_information_timeseries PASSED [ 47%]
tests/unit/utils/test_spatial.py::TestSpatialMI::test_compute_spatial_information_multitimeseries PASSED [ 48%]
tests/unit/utils/test_spatial.py::TestSpatialMI::test_compute_spatial_information_invalid_positions PASSED [ 49%]
tests/unit/utils/test_spatial.py::TestSpeedFiltering::test_filter_by_speed_basic PASSED [ 50%]
tests/unit/utils/test_spatial.py::TestSpeedFiltering::test_filter_by_speed_no_movement PASSED [ 51%]
tests/unit/utils/test_spatial.py::TestSpeedFiltering::test_filter_by_speed_smoothing PASSED [ 52%]
tests/unit/utils/test_spatial.py::TestDirectionFiltering::test_filter_by_direction_basic PASSED [ 53%]
tests/unit/utils/test_spatial.py::TestDirectionFiltering::test_filter_by_direction_wrapped PASSED [ 54%]
tests/unit/utils/test_spatial.py::TestSpatialAnalysisPipeline::test_analyze_spatial_coding_basic PASSED [ 54%]
tests/unit/utils/test_spatial.py::TestSpatialAnalysisPipeline::test_analyze_spatial_coding_with_speed_filter PASSED [ 55%]
tests/unit/utils/test_spatial.py::TestSpatialAnalysisPipeline::test_analyze_spatial_coding_with_logger PASSED [ 56%]
tests/unit/utils/test_spatial.py::TestComputeSpatialMetrics::test_compute_spatial_metrics_all PASSED [ 57%]
tests/unit/utils/test_spatial.py::TestComputeSpatialMetrics::test_compute_spatial_metrics_subset PASSED [ 58%]
tests/unit/utils/test_spatial.py::TestComputeSpatialMetrics::test_compute_spatial_metrics_with_kwargs PASSED [ 59%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_single_print PASSED [ 60%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_multiple_prints PASSED [ 61%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_empty PASSED [ 62%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_with_newlines PASSED [ 63%]
tests/unit/utils/test_output.py::TestCapturing::test_stdout_restored PASSED [ 63%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_exception_handling PASSED [ 64%]
tests/unit/utils/test_output.py::TestCapturing::test_capture_extends_list PASSED [ 65%]
tests/unit/utils/test_output.py::TestShowOutput::test_show_empty_output PASSED [ 66%]
tests/unit/utils/test_output.py::TestShowOutput::test_show_single_line PASSED [ 67%]
tests/unit/utils/test_output.py::TestShowOutput::test_show_multiple_lines PASSED [ 68%]
tests/unit/utils/test_output.py::TestShowOutput::test_show_output_with_empty_strings PASSED [ 69%]
tests/unit/utils/test_output.py::TestIntegration::test_capture_and_show PASSED [ 70%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_identity_correlation PASSED [ 71%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_perfect_correlation PASSED [ 72%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_matches_numpy_corrcoef PASSED [ 72%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_single_observation PASSED [ 73%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_zero_variance PASSED [ 74%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_orthogonal_vectors PASSED [ 75%]
tests/unit/utils/test_correlation_matrix.py::TestCorrelationMatrix::test_partial_correlation PASSED [ 76%]
tests/unit/utils/test_matrix.py::TestIsPositiveDefinite::test_positive_definite_matrix PASSED [ 77%]
tests/unit/utils/test_matrix.py::TestIsPositiveDefinite::test_identity_matrix PASSED [ 78%]
tests/unit/utils/test_matrix.py::TestIsPositiveDefinite::test_not_positive_definite_matrix PASSED [ 79%]
tests/unit/utils/test_matrix.py::TestIsPositiveDefinite::test_singular_matrix PASSED [ 80%]
tests/unit/utils/test_matrix.py::TestIsPositiveDefinite::test_random_spd_matrix PASSED [ 81%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_already_pd_matrix PASSED [ 81%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_symmetric_not_pd PASSED [ 82%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_non_symmetric_matrix PASSED [ 83%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_negative_eigenvalues PASSED [ 84%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_near_singular_matrix PASSED [ 85%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_frobenius_norm_minimization PASSED [ 86%]
tests/unit/utils/test_matrix.py::TestNearestPD::test_iterative_correction PASSED [ 87%]
tests/unit/utils/test_utils_signals.py::test_brownian_single_path PASSED [ 88%]
tests/unit/utils/test_utils_signals.py::test_brownian_multiple_paths PASSED [ 89%]
tests/unit/utils/test_utils_signals.py::test_brownian_with_parameters PASSED [ 90%]
tests/unit/utils/test_utils_signals.py::test_approximate_entropy_regular_signal PASSED [ 90%]
tests/unit/utils/test_utils_signals.py::test_approximate_entropy_random_signal PASSED [ 91%]
tests/unit/utils/test_utils_signals.py::test_approximate_entropy_sine_wave PASSED [ 92%]
tests/unit/utils/test_utils_signals.py::test_timeseries_approximate_entropy_continuous PASSED [ 93%]
tests/unit/utils/test_utils_signals.py::test_timeseries_approximate_entropy_discrete_raises PASSED [ 94%]
tests/unit/utils/test_utils_signals.py::test_filter_1d_timeseries_gaussian PASSED [ 95%]
tests/unit/utils/test_utils_signals.py::test_filter_1d_timeseries_savgol PASSED [ 96%]
tests/unit/utils/test_utils_signals.py::test_filter_signals_2d PASSED    [ 97%]
tests/unit/utils/test_utils_signals.py::test_adaptive_filter_signals PASSED [ 98%]
tests/unit/utils/test_naming.py::test_construct_session_name_old_track PASSED [ 99%]
tests/unit/utils/test_naming.py::test_construct_session_name_standard_track PASSED [100%]

================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.18-final-0 _______________

Name                                                       Stmts   Miss Branch BrPart   Cover   Missing
-------------------------------------------------------------------------------------------------------
src/driada/dim_reduction/dim_reduction.py                     55     55     12      0   0.00%   1-75
src/driada/dimensionality/effective.py                        26     26     12      0   0.00%   1-43
src/driada/dimensionality/intrinsic.py                        52     52     24      0   0.00%   8-180
src/driada/dimensionality/linear.py                           54     54     16      0   0.00%   8-218
src/driada/dimensionality/utils.py                            44     44      8      0   0.00%   1-91
src/driada/gdrive/auth.py                                     13     13      0      0   0.00%   1-18
src/driada/gdrive/upload.py                                   37     37     10      0   0.00%   1-61
src/driada/integration/selectivity_mapper.py                 123    123     58      0   0.00%   8-388
src/driada/intense/pipelines.py                              283    275    164      0   1.79%   191-425, 533-657, 766-887, 985-1110
src/driada/experiment/synthetic/experiment_generators.py     276    263    146      0   3.08%   81-179, 209-279, 364-863
src/driada/network/randomization.py                          232    223     54      0   3.15%   9-105, 110-144, 148-170, 174-186, 192-340
src/driada/utils/visual.py                                   285    271    134      0   3.34%   65-241, 275-361, 404-492, 537-623, 660-709, 742-788
src/driada/intense/disentanglement.py                        148    140     72      0   3.64%   59-122, 177-267, 291-304, 332-391
src/driada/intense/intense_base.py                           406    382    220      0   3.83%   30-61, 86-113, 138-148, 204-224, 282-311, 379-450, 518-632, 694-742, 806-833, 868, 872, 876-877, 881-882, 1050-1337, 1386-1425
src/driada/intense/visual.py                                 236    224     70      0   3.92%   30-54, 89-142, 177-227, 289-345, 381-455, 503-620
src/driada/experiment/synthetic/mixed_selectivity.py         126    116     70      0   5.10%   48-84, 111-157, 185-217, 285-411
src/driada/rsa/core.py                                       165    149     84      0   6.43%   45-78, 110-138, 174-225, 251-275, 320-358, 432-488, 549-595
src/driada/experiment/synthetic/manifold_spatial_3d.py       108     98     46      0   6.49%   37-64, 87-103, 143-196, 253-301, 364-470
src/driada/rsa/core_jit.py                                    95     85     58      0   6.54%   26-107, 129-143, 161-174, 192-204
src/driada/dim_reduction/manifold_metrics.py                 245    223     82      0   6.73%   39-43, 77-102, 130-164, 192-226, 257-288, 314-324, 349-399, 429-462, 493-523, 543-544, 560-569, 593-611, 635-667, 687-725, 752-779, 810-840
src/driada/network/net_base.py                               379    336    168      0   7.86%   19-27, 32-33, 37-41, 45-55, 61-76, 95-151, 159-199, 209-266, 269-270, 274-304, 308-325, 328-338, 341-360, 363-369, 372-378, 381-387, 390-396, 407, 410-477, 482-502, 505-515, 519-530, 533-535, 538-540, 543-545, 548-550, 553-557, 560-570, 573-596
src/driada/experiment/synthetic/time_series.py                88     78     32      0   8.33%   33-96, 117-129, 149-163, 186-196, 215-226, 245-254
src/driada/rsa/visual.py                                      80     71     28      0   8.33%   55-141, 172-210
src/driada/experiment/exp_build.py                           106     92     60      0   8.43%   23-100, 119-183, 187-190, 194-198
src/driada/network/drawing.py                                133    117     54      0   8.56%   13-54, 57-68, 72-75, 80-131, 135-157, 161-174, 179-203
src/driada/experiment/synthetic/utils.py                       7      6      4      0   9.09%   27-34
src/driada/experiment/exp_base.py                            380    328    190      0   9.12%   21-39, 57-170, 173-178, 184-192, 199-226, 232-236, 240-262, 268-285, 293-296, 302-309, 315-343, 349-361, 368-379, 386-400, 414-433, 440-446, 455-466, 474-482, 491-497, 504-510, 524-534, 549-563, 575-592, 595, 608-618, 640-663, 686-707, 714-715, 719-724, 727, 730, 733-734, 751-763, 786-792, 820-839, 843
src/driada/gdrive/download.py                                103     89     46      0   9.40%   21-59, 73-111, 122-170, 174-193
src/driada/dim_reduction/embedding.py                        276    243     72      0   9.48%   17-19, 25-28, 32-36, 45-70, 73-82, 85-90, 94-100, 104-116, 120-126, 129-131, 134-138, 141-162, 165-173, 176, 179-195, 198-200, 203-208, 221-408, 418-514, 519-523, 546-553
src/driada/network/matrix_utils.py                           203    178     60      0   9.51%   18-31, 35-36, 40-45, 58-96, 100-107, 111-118, 122-124, 129-175, 179-186, 190-195, 199, 207-210, 214-223, 227-234, 238-249, 253-261, 266-270, 274-281, 285-292, 296-303, 307-310, 314-317
src/driada/dim_reduction/mvu.py                               61     53     20      0   9.88%   22-29, 40-109, 122-146
src/driada/experiment/synthetic/manifold_circular.py          73     63     24      0  10.31%   33-45, 68-69, 107-139, 190-237, 285-376
src/driada/dim_reduction/graph.py                            174    151     46      0  10.45%   26-59, 66-79, 82-83, 86-96, 99-105, 109-140, 143-147, 152-189, 193-278, 281-286
src/driada/network/spectral.py                                30     26      8      0  10.53%   6-8, 24-37, 41-55
src/driada/rsa/integration.py                                 46     38     22      0  11.76%   63-108, 139-141, 188-219
src/driada/intense/stats.py                                  105     87     44      0  12.08%   24-25, 44-46, 65-67, 89-92, 118-126, 152-155, 176-186, 211-215, 244-252, 273-280, 314-346, 365-375, 394-399
src/driada/information/entropy_jit.py                         44     38      4      0  12.50%   33-67, 86-129
src/driada/utils/neural.py                                    20     17      4      0  12.50%   25-45, 49-54
src/driada/experiment/wavelet_event_detection.py             156    130     40      1  13.78%   9, 39-42, 46-109, 117-164, 168-169, 173-181, 191-209, 213-249, 255-276, 281-289
src/driada/information/ksg.py                                 87     71     20      0  14.95%   17, 22, 26-27, 31, 39-42, 50-68, 78-86, 93-96, 105-141, 145-164
src/driada/experiment/spike_reconstruction.py                 48     39      8      0  16.07%   49-62, 93-126, 160-215
src/driada/network/quantum.py                                 39     31      8      0  17.02%   7-14, 18-27, 31-33, 37-55
src/driada/gdrive/gdrive_utils.py                             74     56     30      0  17.31%   25-28, 31, 61-107, 141-200, 204-210
src/driada/utils/data.py                                     150    114     72      1  17.57%   34-54, 58-62, 66-87, 92-108, 116-135, 139-141, 146-148, 152-155, 159-169, 221-223, 228-231, 238-241, 253-270, 284-315
src/driada/dim_reduction/dr_base.py                           80     58     44      0  17.74%   157-173, 181-196, 205-213, 232-278
src/driada/experiment/neuron.py                              161    126     36      0  17.77%   35-36, 41-44, 49-50, 54-57, 63-96, 99, 102-107, 110-112, 115-124, 127-130, 133-136, 144-151, 155-165, 170-183, 187-200, 204-212, 216-228, 232-255
src/driada/network/graph_utils.py                             46     36     10      0  17.86%   9-13, 18-28, 32-35, 39-43, 47-49, 53-75
src/driada/dim_reduction/data.py                             112     84     50      3  19.14%   13-18, 37, 44-45, 54, 59-64, 81-86, 103-133, 169-225, 228-233, 236-238, 241-243
src/driada/dim_reduction/neural.py                           132    101     24      1  20.51%   12-16, 22-43, 46-54, 61-82, 85-90, 96-117, 120-127, 133-140, 143-145, 148-150, 156-163, 170-173, 176-190, 194-198, 202-203, 211-212, 215, 218-226
src/driada/information/entropy.py                             56     41     14      0  21.43%   18-19, 42-52, 68, 89-99, 123-135, 157-167, 192-195, 218-221
src/driada/experiment/wavelet_ridge.py                        66     50      4      0  22.86%   26-27, 34-56, 60-66, 70, 74-85, 90-102, 106-107
src/driada/information/gcmi_jit_utils.py                     207    157     66      3  23.08%   73-79, 104, 106, 122-134, 171-177, 200-259, 286-386, 405-421, 443-456
src/driada/information/gcmi.py                               251    179     78      7  24.62%   16-17, 30-35, 59, 82-92, 126-127, 144-170, 193, 200, 206, 224->232, 253-314, 326-360, 379-442, 457-508
src/driada/information/info_base.py                          389    237    176     23  34.51%   29-45, 49, 56, 71, 84, 87-91, 94-95, 98-102, 105-106, 109-111, 114-123, 146-159, 226-239, 263-264, 269-271, 283, 287, 296, 301, 306, 311, 317-319, 322-327, 345-351, 357-360, 365-372, 399-402, 413-445, 475-478, 487->494, 491-492, 495-500, 514-517, 581-584, 591-592, 597-626, 628->exit, 634-679, 688-691, 697-708, 741-749, 793-882, 921-937
src/driada/information/info_utils.py                          41     25      8      1  38.78%   11-12, 24-34, 38-62
src/driada/utils/jit.py                                       29     17      4      1  39.39%   17-25, 58-60, 68, 73-78
src/driada/experiment/synthetic/manifold_spatial_2d.py        98     54     40      4  40.58%   37->40, 56-57, 135->138, 143-161, 238-286, 341-440
src/driada/utils/signals.py                                   82     29     34      6  57.76%   88->93, 216, 233, 237, 241-286, 309
src/driada/experiment/synthetic/core.py                       40     14     16      5  58.93%   37->exit, 45->47, 75-80, 89, 97, 146-161
src/driada/utils/naming.py                                    13      3      6      1  68.42%   24-27
src/driada/utils/spatial.py                                  214     14     74     11  89.93%   62, 152->160, 213, 317->321, 463-468, 485-488, 540, 587, 595, 754->759, 769->773, 773->777
src/driada/utils/gif.py                                       38      0     14      0 100.00%
src/driada/utils/matrix.py                                    24      0      4      0 100.00%
src/driada/utils/output.py                                    16      0      4      0 100.00%
src/driada/utils/plot.py                                      38      0     18      0 100.00%
-------------------------------------------------------------------------------------------------------
TOTAL                                                       8004   6530   3128     68  15.15%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
Coverage JSON written to file coverage.json
============================= 111 passed in 8.25s ==============================

