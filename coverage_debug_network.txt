============================= test session starts ==============================
platform darwin -- Python 3.10.18, pytest-8.4.1, pluggy-1.6.0 -- /opt/anaconda3/envs/driada/bin/python
cachedir: .pytest_cache
rootdir: /Users/nikita/PycharmProjects/driada2
configfile: pytest.ini
plugins: timeout-2.4.0, cov-6.2.1
collecting ... collected 85 items

tests/unit/network/test_randomization.py::TestValidation::test_validate_adjacency_matrix_valid PASSED [  1%]
tests/unit/network/test_randomization.py::TestValidation::test_validate_adjacency_matrix_invalid PASSED [  2%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_basic PASSED [  3%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_preserves_degree_sequence PASSED [  4%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_weighted PASSED [  5%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_with_logging PASSED [  7%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_progress_bar PASSED [  8%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_reproducibility PASSED [  9%]
tests/unit/network/test_randomization.py::TestIOMPreserving::test_iom_small_graph_warning PASSED [ 10%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_basic PASSED [ 11%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_partial_shuffle PASSED [ 12%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_symmetry_preserved PASSED [ 14%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_invalid_input PASSED [ 15%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_invalid_p PASSED [ 16%]
tests/unit/network/test_randomization.py::TestCompleteGraphRandomization::test_complete_sparse_input PASSED [ 17%]
tests/unit/network/test_randomization.py::TestDenseGraphRandomization::test_dense_basic PASSED [ 18%]
tests/unit/network/test_randomization.py::TestDenseGraphRandomization::test_dense_complete_graph PASSED [ 20%]
tests/unit/network/test_randomization.py::TestDenseGraphRandomization::test_dense_gap_filling PASSED [ 21%]
tests/unit/network/test_randomization.py::TestDenseGraphRandomization::test_dense_sparse_input PASSED [ 22%]
tests/unit/network/test_randomization.py::TestHelperFunctions::test_get_single_double_edges_lists PASSED [ 23%]
tests/unit/network/test_randomization.py::TestHelperFunctions::test_legacy_function_deprecation PASSED [ 24%]
tests/unit/network/test_randomization.py::TestUnifiedAPI::test_unified_iom PASSED [ 25%]
tests/unit/network/test_randomization.py::TestUnifiedAPI::test_unified_complete PASSED [ 27%]
tests/unit/network/test_randomization.py::TestUnifiedAPI::test_unified_dense PASSED [ 28%]
tests/unit/network/test_randomization.py::TestUnifiedAPI::test_unified_invalid_method PASSED [ 29%]
tests/unit/network/test_randomization.py::TestUnifiedAPI::test_unified_logging PASSED [ 30%]
tests/unit/network/test_randomization.py::TestEdgeCases::test_empty_graph PASSED [ 31%]
tests/unit/network/test_randomization.py::TestEdgeCases::test_single_edge_graph PASSED [ 32%]
tests/unit/network/test_randomization.py::TestEdgeCases::test_self_loops_ignored PASSED [ 34%]
tests/unit/network/test_network.py::test_init_from_adj PASSED            [ 35%]
tests/unit/network/test_network.py::test_init_from_graph PASSED          [ 36%]
tests/unit/network/test_network.py::test_remove_isolates PASSED          [ 37%]
tests/unit/network/test_network.py::test_take_giant_cÑ PASSED            [ 38%]
tests/unit/network/test_network.py::test_take_giant_scc PASSED           [ 40%]
tests/unit/network/test_network.py::test_diagonalize PASSED              [ 41%]
tests/unit/network/test_network.py::test_assign_random_weights PASSED    [ 42%]
tests/unit/network/test_network.py::test_matrix_utils_edge_cases PASSED  [ 43%]
tests/unit/network/test_network.py::test_turn_to_partially_directed_weighted PASSED [ 44%]
tests/unit/network/test_network.py::TestNetworkModuleImports::test_import_drawing PASSED [ 45%]
tests/unit/network/test_network.py::TestNetworkModuleImports::test_import_quantum PASSED [ 47%]
tests/unit/network/test_network.py::TestNetworkModuleImports::test_import_spectral PASSED [ 48%]
tests/unit/network/test_network.py::TestNetworkModuleImports::test_import_randomization PASSED [ 49%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_matrix_type_valid PASSED [ 50%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_matrix_type_invalid PASSED [ 51%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_adjacency_valid PASSED [ 52%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_adjacency_invalid PASSED [ 54%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_directed_valid PASSED [ 55%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_directed_invalid PASSED [ 56%]
tests/unit/network/test_network.py::TestHelperFunctions::test_check_weights_and_directions PASSED [ 57%]
tests/unit/network/test_network.py::TestHelperFunctions::test_select_construction_pipeline PASSED [ 58%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_init_with_node_attributes PASSED [ 60%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_init_without_nx_graph_creation PASSED [ 61%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_init_with_preprocessing_none PASSED [ 62%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_init_invalid_preprocessing PASSED [ 63%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_directed_detection PASSED [ 64%]
tests/unit/network/test_network.py::TestNetworkInitialization::test_weighted_detection PASSED [ 65%]
tests/unit/network/test_network.py::TestNetworkMethods::test_is_connected PASSED [ 67%]
tests/unit/network/test_network.py::TestNetworkMethods::test_get_degree_distr PASSED [ 68%]
tests/unit/network/test_network.py::TestNetworkMethods::test_randomize_methods PASSED [ 69%]
tests/unit/network/test_network.py::TestNetworkMethods::test_get_node_degrees PASSED [ 70%]
tests/unit/network/test_network.py::TestNetworkMethods::test_get_matrix_caching PASSED [ 71%]
tests/unit/network/test_network.py::TestNetworkMethods::test_diagonalize_methods PASSED [ 72%]
tests/unit/network/test_network.py::TestNetworkMethods::test_calculate_ipr PASSED [ 74%]
tests/unit/network/test_network.py::TestNetworkMethods::test_calculate_z_values PASSED [ 75%]
tests/unit/network/test_network.py::TestNetworkMethods::test_thermodynamic_methods PASSED [ 76%]
tests/unit/network/test_network.py::TestNetworkMethods::test_thermodynamic_directed_network PASSED [ 77%]
tests/unit/network/test_network.py::TestNetworkMethods::test_estrada_methods PASSED [ 78%]
tests/unit/network/test_network.py::TestNetworkMethods::test_localization_signatures PASSED [ 80%]
tests/unit/network/test_network.py::TestNetworkMethods::test_construct_lem_embedding PASSED [ 81%]
tests/unit/network/test_network.py::TestNetworkMethods::test_construct_lem_embedding_directed_error PASSED [ 82%]
tests/unit/network/test_network.py::TestNetworkMethods::test_construct_lem_embedding_disconnected_error PASSED [ 83%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_graph_with_selfloops PASSED [ 84%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_isolated_nodes_in_connected_component PASSED [ 85%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_complex_eigenvalues_directed PASSED [ 87%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_invalid_matrix_mode PASSED [ 88%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_degree_distribution_edge_cases PASSED [ 89%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_node_degrees_uniform_case PASSED [ 90%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_diagonalize_errors PASSED [ 91%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_diagonalize_laplacian_components PASSED [ 92%]
tests/unit/network/test_network.py::TestNetworkEdgeCases::test_complex_eigenvectors_undirected_error PASSED [ 94%]
tests/unit/network/test_network.py::TestNetworkWithRealGraphs::test_karate_club_network PASSED [ 95%]
tests/unit/network/test_network.py::TestNetworkWithRealGraphs::test_directed_graph_from_nx PASSED [ 96%]
tests/unit/network/test_network.py::TestNetworkWithRealGraphs::test_weighted_graph_from_nx PASSED [ 97%]
tests/unit/network/test_network.py::TestNetworkWithRealGraphs::test_network_with_node_positions PASSED [ 98%]
tests/unit/network/test_network.py::TestNetworkWithRealGraphs::test_preprocessing_with_verbose_output PASSED [100%]

================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.18-final-0 _______________

Name                                                       Stmts   Miss Branch BrPart   Cover   Missing
-------------------------------------------------------------------------------------------------------
src/driada/dimensionality/effective.py                        27     27     12      0   0.00%   1-48
src/driada/dimensionality/intrinsic.py                       119    119     48      0   0.00%   8-403
src/driada/dimensionality/linear.py                           54     54     16      0   0.00%   8-218
src/driada/dimensionality/utils.py                            42     42      8      0   0.00%   1-91
src/driada/gdrive/auth.py                                     13     13      0      0   0.00%   1-19
src/driada/gdrive/upload.py                                   37     37     10      0   0.00%   1-69
src/driada/integration/selectivity_mapper.py                 124    124     60      0   0.00%   8-430
src/driada/intense/pipelines.py                              288    279    170      0   1.97%   194-469, 579-703, 814-940, 1040-1175
src/driada/utils/visual.py                                   283    271    134      0   2.88%   63-270, 304-405, 448-546, 591-681, 718-778, 811-858
src/driada/experiment/synthetic/experiment_generators.py     276    263    146      0   3.08%   100-216, 254-338, 433-1037
src/driada/intense/disentanglement.py                        148    140     72      0   3.64%   59-122, 183-281, 305-320, 349-407
src/driada/intense/visual.py                                 236    224     70      0   3.92%   30-66, 112-174, 218-292, 364-424, 466-549, 605-754
src/driada/intense/intense_base.py                           410    384    220      0   4.13%   25-27, 48-93, 120-148, 175-185, 248-270, 329-361, 438-518, 587-732, 796-851, 917-948, 984, 988, 992-993, 997-998, 1167-1492, 1541-1582
src/driada/experiment/synthetic/mixed_selectivity.py         143    133     80      0   4.48%   56-92, 128-205, 243-281, 361-516
src/driada/utils/naming.py                                    13     12      6      0   5.26%   2-27
src/driada/rsa/core.py                                       164    148     84      0   6.45%   47-85, 117-144, 180-235, 257-283, 328-368, 442-509, 570-622
src/driada/experiment/synthetic/manifold_spatial_3d.py       108     98     46      0   6.49%   39-66, 89-105, 152-207, 275-328, 402-496
src/driada/rsa/core_jit.py                                    95     85     58      0   6.54%   26-106, 128-142, 160-173, 191-203
src/driada/dim_reduction/manifold_metrics.py                 313    286     98      0   6.57%   39-43, 77-102, 126-160, 184-218, 249-280, 302-312, 335-385, 417-460, 491-518, 539-540, 556-558, 574-583, 615-652, 673-693, 731-781, 807-828, 865-900, 922-962, 996-1026, 1060-1088, 1122-1167
src/driada/rsa/visual.py                                      78     71     28      0   6.60%   53-155, 186-224
src/driada/utils/spatial.py                                  213    194     74      0   6.62%   60-93, 129-162, 195-232, 256-274, 300-336, 380-421, 450-494, 522-548, 576-603, 652-725, 754-780
src/driada/experiment/exp_base.py                            464    414    268      0   6.83%   57-92, 120-297, 302-308, 316-326, 333-360, 367-380, 388-431, 438-479, 489-492, 498-505, 511-541, 547-559, 566-580, 587-605, 619-643, 652-660, 679-693, 705-713, 724-731, 738-745, 772-803, 830-867, 881-900, 905, 937-995, 1019-1044, 1069-1095, 1101-1102, 1105-1110, 1113, 1116, 1119-1120, 1142-1154, 1177-1185, 1219-1241, 1245
src/driada/information/gcmi.py                               250    227     78      0   7.01%   37-38, 46-61, 70-84, 102-112, 136-153, 164-195, 215-260, 280-341, 353-391, 411-478, 493-544
src/driada/dim_reduction/graph.py                            242    218     90      0   7.23%   26-76, 83-96, 99-100, 103-116, 121-139, 142-200, 203-215, 219-275, 279-385, 390-397, 460-546
src/driada/information/info_base.py                          457    408    220      0   7.24%   46-73, 90-112, 116-151, 189-274, 277-281, 284-285, 288-292, 295-298, 301-303, 306-315, 338-356, 399-411, 434-528, 533, 536-553, 556-558, 561-580, 598-621, 633-636, 641-648, 676-751, 777-883, 913-1028, 1032-1037, 1043-1054, 1087-1097, 1141-1247, 1286-1302
src/driada/experiment/synthetic/manifold_spatial_2d.py        98     88     40      0   7.25%   39-66, 88-95, 142-193, 260-313, 380-471
src/driada/experiment/exp_build.py                           119    105     72      0   7.33%   26-143, 164-233, 237-240, 244-250
src/driada/information/gcmi_jit_utils.py                     206    186     66      0   7.35%   25-53, 72-78, 98-143, 164-165, 182-188, 211-270, 297-397, 416-432, 454-467
src/driada/dim_reduction/embedding.py                        328    294     82      0   8.29%   19-21, 29-33, 42-67, 70-81, 84-89, 93-100, 104-118, 121-142, 145-147, 150-154, 157-178, 181-196, 212-279, 287-305, 308-310, 313-319, 345-571, 595-743, 748-752, 775-782
src/driada/dim_reduction/data.py                             128    111     66      0   8.76%   32-53, 97-124, 127-141, 158-163, 180-212, 255-335, 338-343, 346-348, 351-353
src/driada/network/drawing.py                                134    117     54      0   9.04%   14-59, 63-74, 78-81, 94-150, 154-178, 182-195, 200-225
src/driada/experiment/synthetic/utils.py                       7      6      4      0   9.09%   28-37
src/driada/gdrive/download.py                                103     89     46      0   9.40%   30-79, 94-138, 151-212, 216-241
src/driada/utils/signals.py                                   82     71     34      0   9.48%   81-98, 156-177, 218-289, 313-320, 339-359
src/driada/information/time_series_types.py                  231    198    116      0   9.51%   35, 39, 43, 47, 78-133, 152-219, 226-259, 266-348, 356-449, 461-487, 498-502, 514-536, 559-563
src/driada/utils/data.py                                     157    135     74      0   9.52%   34-52, 56-60, 64-85, 90-106, 112-141, 145-147, 164-177, 181-184, 188-198, 216-238, 250-252, 294-305, 309-315, 327-344, 358-389
src/driada/experiment/synthetic/time_series.py                79     69     24      0   9.71%   33-80, 101-117, 137-151, 174-184, 203-228, 247-258
src/driada/experiment/synthetic/manifold_circular.py          73     63     24      0  10.31%   33-45, 68-69, 113-145, 204-255, 312-402
src/driada/experiment/synthetic/core.py                       39     33     16      0  10.91%   36-46, 73-114, 154-171
src/driada/utils/plot.py                                      37     31     18      0  10.91%   55-80, 119-135, 173-186
src/driada/dim_reduction/mvu.py                               68     58     22      0  11.11%   8-10, 37-50, 61-146, 158-184
src/driada/intense/stats.py                                  104     87     44      0  11.49%   23-24, 43-45, 64-66, 88-91, 117-125, 151-154, 175-187, 212-216, 245-253, 274-281, 317-353, 372-382, 401-406
src/driada/rsa/integration.py                                 46     38     22      0  11.76%   62-113, 146-148, 195-233
src/driada/information/entropy_jit.py                         44     38      4      0  12.50%   32-66, 85-128
src/driada/utils/neural.py                                    20     17      4      0  12.50%   22-46, 52-59
src/driada/experiment/wavelet_event_detection.py             154    130     40      1  12.89%   8, 37-40, 46-123, 131-189, 195-201, 211-225, 242-262, 266-309, 324-345, 350-358
src/driada/information/info_utils.py                          41     34      8      0  14.29%   7-38, 43-71, 75-99
src/driada/utils/matrix.py                                    24     20      4      0  14.29%   17-45, 50-54
src/driada/dim_reduction/sequences.py                         22     17     12      0  14.71%   67-101
src/driada/information/ksg.py                                 87     71     20      0  14.95%   30, 35, 39-42, 46, 54-57, 65-83, 93-101, 108-111, 129-169, 173-192
src/driada/experiment/spike_reconstruction.py                 48     39      8      0  16.07%   49-62, 91-122, 154-206
src/driada/dim_reduction/dr_base.py                           82     61     46      0  16.41%   191-215, 223-238, 247-256, 277-339
src/driada/gdrive/gdrive_utils.py                             73     56     30      0  16.50%   25-28, 31, 61-105, 135-194, 198-204
src/driada/experiment/neuron.py                              172    135     38      0  17.62%   74-75, 79-82, 105-106, 128-131, 144-179, 196-215, 220-225, 228-230, 233-242, 245-248, 251-254, 261-276, 295-302, 306-319, 322-335, 338-354, 378-387, 390-424
src/driada/utils/gif.py                                       36     27     14      0  18.00%   21-29, 44-53, 81-108
src/driada/network/quantum.py                                 40     31      8      0  18.75%   9-28, 32-41, 45-47, 51-69
src/driada/information/entropy.py                             55     41     14      0  20.29%   18-19, 42-52, 68, 89-101, 125-139, 161-173, 198-201, 224-227
src/driada/dim_reduction/neural.py                           132    101     24      1  20.51%   12-16, 22-43, 46-56, 63-84, 87-94, 100-121, 124-133, 139-158, 161-163, 166-168, 182-201, 208-211, 214-228, 232-236, 240-241, 249-250, 253, 256-264
src/driada/experiment/wavelet_ridge.py                        66     50      4      0  22.86%   26-27, 34-56, 59-65, 68, 71-82, 87-99, 103-107
src/driada/utils/output.py                                    16     10      4      0  30.00%   7-9, 12-14, 18-22
src/driada/utils/jit.py                                       27     17      4      1  35.48%   20-30, 63-66, 74, 79-85
src/driada/network/graph_utils.py                             47     22     12      1  47.46%   30, 53-55, 59-81
src/driada/network/spectral.py                                30     11      8      4  60.53%   25, 32, 35, 46-53
src/driada/network/randomization.py                          310    100     94      5  70.05%   330, 337-338, 443, 493-570, 575-639
src/driada/network/net_base.py                               387     16    172     17  93.38%   149->152, 153->161, 158->161, 204, 293, 312, 332-338, 421, 460->464, 497, 501, 520, 536-537, 549->552, 563, 568, 657->661
src/driada/network/matrix_utils.py                           203      8     60      0  96.20%   255-263
-------------------------------------------------------------------------------------------------------
TOTAL                                                       8752   7102   3552     30  15.78%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
Coverage JSON written to file coverage.json
============================= 85 passed in 11.04s ==============================

